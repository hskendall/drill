# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Configuration for the Drill-on-YARN client. Provides information needed to
# launch the Drill Application Master under YARN. A separate file,
# drill-cluster.conf, configures the Drill cluster itself.
#
# This file is in HOCON format, see https://github.com/typesafehub/config/blob/master/HOCON.md for more information.

drill.yarn: {

    # Name displayed in the YARN management UI for your Drill cluster.

    appName: "Drill-on-YARN"

    # The distributed file system (HDFS) directory in which to store the Drill
    # archive file. Note that you must also set this option to the same value
    # in drill-cluster.conf.

    dfsdir: "/users/drill"

    client: {

        # The archive (in .tar.gz format) that contains your Drill software, your custom jar files,
        # and your Drill configuration.

        archive: "/etc/drill/drill.tar.gz"
    }

    # Application Master settings. You should not have to change these.

    am {
        memoryMb: 128
        vcores: 1
    }

    # Configuration for each Drillbit. Drill requires that all Drillbits use the
    # same configuration.

    drillbit {
        # The amount of memory to allocate to each Drill-bit. This is the amount of memory requested
        # from YARN for each drill-bit. This must be sufficient for
        # the amount of heap memory allocated in drill-env.sh, and the off-heap memory
        # allocated in drill-override.conf.

        memoryMb: 1024

        # The number of YARN virtual cores to allocate to each drill-bit.

        vcores: 4
    }

    # Configuration of the overall cluster.

    cluster: {

        # The pools of hosts on which to launch Drill. Each pool can be one of several types.
        #
        # Note: This version supports a single pool. The example below has multiple pools
        # only to illustrate the various pool types.

        pools: [
            {
                # Arbitrary name, just used for error and statistics reporting.

                name: "pool1"

                # Basic pool: let YARN pick any available node.

                type: "basic"

                # Number of Drill-bits to run. (Drill-on-YARN runs each on a separate host,
                # so this is also the number of hosts that will run Drill.)

                count: 2
            },
            {
                name: "pool2"

                # Labelded pool: Use YARN labels to identify which nodes should run Drill.

                type: "labeled"

                # The YARN label expression to use to select nodes.

                label: "drill"

                # The number of Drill-bits (hosts) to request.

                count: 2
            }
        ]
    }
}