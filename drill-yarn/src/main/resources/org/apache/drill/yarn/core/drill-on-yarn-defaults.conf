# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Client defaults.
# See drill-on-yarn-example.conf for details.
# Some properties are private; the are meant for use by the Drill
# developers. Those are marked as private here, and are explained here
# rather than in the example config.

drill.yarn: {
  app-name: "Drill-on-YARN"
  cluster-id: "drillbits1"

  # Settings here support a default single-node cluster on the local host,
  # using the default HDFS connection obtained from the Hadoop config files.

  dfs: {
    connection: ""
    app-dir: "/user/drill"
  }

  drill-install: {
    site-dir: ""
    client-path: ""
    dir-name: "<base>"

    # Drill-on-YARN uses localization by default; it is the simplest and
    # most reliable for production systems. However, localization can be
    # disabled for development, testing or other special needs.

    localize: true

    # When localization is disabled, the path to Drill software defaults
    # to the same location as on the client node. However, if the path
    # on worker nodes is different, set the actual path here.

    drill-home: ""

    # Drill provides the option to store site-specific configuration outside
    # of the Drill home directory. The site directory contains configuration
    # files and custom Java code (in the jars subdirectory.) The site dir
    # normally is localized by the client. However, in a non-localized
    # run, use this setting to identify the location of the site directory
    # on each worker node if the location is different than the node
    # that runs the client.

    site-dir: ""

    # Key used for the Drill archive file in the AM launch config.
    # Not usually changed by users.

    drill-key: "drill"
    site-key: "site"
  }

  # Copy of the ZK parameters in drill's configuration.
  # Should read directly from Drill at some point.
  # This setup supports the default Drill single-node cluster.

  zk: {
    connect: "localhost:2181",
    root: "drill",
    refresh: 500,
    timeout: 5000,
    retry: {
      count: 7200,
      delay: 500
    }
  }

  yarn: {
    queue: "default"
    priority: 1
    user: ""
  }

  hadoop: {
    home: ""
    class-path: ""
    hbase-class-path: ""
  }

  client: {

    # Time (in secs) between poll attempts on start and stop.

    poll-sec: 1

    # Maximum time to wait when starting the AM before asking the
    # user to check status later.

    start-wait-sec: 30

    # Maximum time to wait when stopping the AM before skipping
    # the confirmation step.

    stop-wait-sec: 30
  }

  am: {
    memory-mb: 512

    # The AM is CPU-light, a single core will do.

    vcores: 1

    # The AM uses no disk. Available on selected YARN distributions.

    disks: 0

    # Heap memory for the AM. Estimate based on observation.

    heap: "450M"

    # Arguments passed to the AM JVM. (Private)

    vm-args: ""

    # AM-to-RM period in ms. (Private)

    poll-ms: 1000

    # AM clock tick period in ms. (Private)

    tick-ms: 2000

    # Set to true to dump launch variables and command to log.

    debug-launch: false

    # Extra class path for AM. The path must be valid on all nodes.
    # Not normally used; provided only for special cases to avoid editing
    # the launch script. This is a class path prefix to allow overrides
    # of Drill classes.
    # Analogous to DRILL_CLASSPATH_PREFIX in drill-config.sh
    # Multiple entries should be separated by colons.

    prefix-class-path: ""

    # Extra class path for AM. The path must be valid on all nodes on which
    # the AM may run.
    # Not normally used; provided only for special cases to avoid editing
    # the launch script.

    class-path: ""
  }

  drillbit: {
    # Default memory: 4096 (heap) + 8192 (direct) + some overhead.

    memory-mb: 13000
    vcores: 4
    disks: 1

    heap: "4G"
    max-direct-memory: "8G"

    # Additional JVM arguments for the drillbit (Private)
    # The value here is appended to any set in the launch script.
    # Separate multiple arguments by spaces.

    vm-args: ""

    # Set to true to turn on garbage collection logging.
    # Similar to SERVER_GC_OPTS in drillbit.sh. However under YARN
    # all logging goes to YARN's log directory and the GC log is
    # always called "gc.log".

    log-gc: false

    # Extra class path for Drill-bit. The path must be valid on all nodes.
    # Not normally used; provided only for special cases to avoid editing
    # the launch script. This is a class path prefix to allow overrides
    # of Drill classes.
    # Equivalent to DRILL_CLASSPATH_PREFIX in drill-config.sh
    # Multiple entries should be separated by colons.

    prefix-class-path: ""

    # Extra class path for Drill extensions such as Hadoop or HBase.
    # The path must be valid on all nodes. Inserted into Drill's
    # class path before Drill's own third-party extensions; allows
    # overriding of Drill's own included jars.
    # Equivalent to HADOOP_CLASSPATH and HBASE_CLASSPATH
    # in drill-config.sh

    extn-class-path: ""

    # Normal class path specification for jars added to Drill's own.
    # Appears in the class path after Drill's jars. Useful for dependencies
    # on custom data source implementations.
    # The path must be valid on all nodes.
    # Equivalent to DRILL_CLASSPATH in drill-config.sh

    class-path: ""

    # Maximum number of retries of each Drillbit before blacklisting the node.

    max-retries: 3

    # Set to true to dump launch variables and command to log.

    debug-launch: false

    # Set here because a Drillbit does not advertise its port.

    http-port: 8047

    # Disable normal YARN log location. Allows Drill to write to
    # it's own log location as when running outside of YARN. However,
    # under YARN, log aggregation is generally considerd a "good thing."

    disable-yarn-logs: false
  }

  http: {
    enabled: true
    port: 8048
    ssl-enabled: false
    auth-enabled: false
    rest-key="secret"
  }

  pools: [

    # Defined to support a demo single-node cluster.

    {
      name: "default"
      type: "basic"
      count: 1
    }
  ]
}